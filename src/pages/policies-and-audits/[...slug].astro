---
/* 
This page is to set up Policies & Audits parent level pages layout and routes except for smart bulletins. 
It includs landing page (/policies-and-audits/), Policies page (/policies-and-audits/policies), Audit Reporistory page (/policies-and-audits/audits)
Page use side nav or use full size template based on frontmatter full_size_template value is provided or not. 
*/
import PageLayout from '@layouts/PageLayout.astro';
import PageContentLayout from '@layouts/PageContentLayout.astro';
import SideNav from '@components/SideNav.astro'
import FullSizeTemplate from '@components/FullSizeTemplate.astro'
import { getCollection, getEntry } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('policies-and-audits');
  const smartbulletinsData = await getEntry('smartbulletins', 'smart-bulletins');

  return entries.map(entry => {
    const slug = entry.slug == './' ? undefined : entry.slug
    return {
      params: { slug: slug },
      props: { entry, entries, smartbulletinsData }
    }
  })
}
const { entry, entries, smartbulletinsData } = Astro.props;
const { Content, headings } = await entry.render();
const parent_path ="policies-and-audits/"
---

{entry.data.full_size_template
  ? (
    <PageLayout title={entry.data.title}>
      <FullSizeTemplate 
        title={ entry.data.title }
        parent_nav_path="policies-and-audits" 
        parent_nav_text = "Return to the Policies & Audits" 
        intro ={entry.data.intro}
      >
        <Content />
      </FullSizeTemplate>
    </PageLayout>
  )
  : (
    <PageLayout title={entry.data.title}>
        <SideNav 
          title="Policies & Audits"
          parent_path={parent_path}
          pages={[...entries, smartbulletinsData]}
          headings={headings}
          id={entry.id}
        />  
        <PageContentLayout
          title={entry.data.title}
          intro={entry.data.intro}
        >
          <Content />
      </PageContentLayout>
    </PageLayout>
  )
}

    
