---
import PageLayout from '@layouts/PageLayout.astro';
import SideNav from '@components/SideNav.astro';
import SinglePageSideNav from '@components/SinglePageSideNav.astro';

import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('contact');
  return entries.map(entry => {
    const slug = entry.slug == './' ? undefined : entry.slug
    return {
      params: { slug: slug },
      props: { entry, entries }
    }
  })
}
const { entry, entries } = Astro.props;
/*
  The contact pages have a different side nav for the index than 
  for the rest of the contact pages. 
*/

const non_index_entries = entries.filter(entry => entry.slug != './');
const { Content, headings } = await entry.render();
---
<PageLayout title={entry.data.title}>
  
    {  entry.slug != './' 
    ? (
      <SideNav 
        title="Contact"
        parent_path="contact/"
        pages={non_index_entries}
        headings={headings}
        id={entry.id}
      />
    )
    : (
    <SinglePageSideNav
      title="Contact"
      headings={headings}
      parent_path="contact/"
    />
    )
  }
  
  <div class="usa-layout-docs__main desktop:grid-col-8 usa-prose usa-layout-docs">
    <h1>{ entry.data.title }</h1>

    { entry.data.intro && ( 
      <p class="usa-intro">
        { entry.data.intro }
      </p>
    )}

    <Content />
</div>
</PageLayout>
    
